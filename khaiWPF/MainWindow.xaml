<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="khaiWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:khaiWPF"
        Title="FU Mini Hotel Management System" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen" WindowState="Maximized"
        ResizeMode="CanResize">
    <Window.Resources>
        <local:BookingStatusConverter x:Key="BookingStatusConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="60"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#FF4A90E2" BorderBrush="#FF2E6DA4" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal" Margin="20,0">
                <TextBlock Text="FU Mini Hotel System" 
                           FontSize="20" FontWeight="Bold" Foreground="White"
                           VerticalAlignment="Center"/>
                <TextBlock x:Name="lblWelcome" Text="Welcome, Admin" 
                           FontSize="14" Foreground="White" Margin="50,0,0,0"
                           VerticalAlignment="Center"/>
                <Button x:Name="btnLogout" Content="Đăng xuất" 
                        Background="Transparent" Foreground="White" 
                        BorderBrush="White" BorderThickness="1"
                        Padding="15,5" Margin="700,0,0,0" HorizontalAlignment="Right"
                        Click="btnLogout_Click" VerticalAlignment="Center"
                        Cursor="Hand"/>
            </StackPanel>
        </Border>

        <!-- Content -->
        <TabControl Grid.Row="1" x:Name="tabMain" Margin="10" Background="#FFF5F6FA">
            <!-- Customer Management Tab -->
            <TabItem x:Name="tabCustomers" Header="Quản lý Khách hàng" FontSize="14">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Search and Actions -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Tìm kiếm:" VerticalAlignment="Center" Margin="0,0,10,0" FontSize="14"/>
                        <TextBox x:Name="txtSearchCustomer" Width="300" Height="30" 
                                 Padding="5" VerticalAlignment="Center" FontSize="14"/>
                        <Button x:Name="btnSearchCustomer" Content="Tìm kiếm" 
                                Width="80" Height="30" Margin="10,0" FontSize="14"
                                Background="#FF007BFF" Foreground="White" Cursor="Hand"
                                Click="btnSearchCustomer_Click"/>
                        <Button x:Name="btnAddCustomer" Content="Thêm Khách hàng" 
                                Width="120" Height="30" Margin="10,0" FontSize="14"
                                Background="#FF28A745" Foreground="White" Cursor="Hand"
                                Click="btnAddCustomer_Click"/>
                        <Button x:Name="btnRefreshCustomer" Content="Làm mới" 
                                Width="80" Height="30" Margin="10,0" FontSize="14"
                                Background="#FF6C757D" Foreground="White" Cursor="Hand"
                                Click="btnRefreshCustomer_Click"/>
                    </StackPanel>

                    <!-- Customer DataGrid -->
                    <DataGrid Grid.Row="1" x:Name="dgCustomers" AutoGenerateColumns="False"
                              CanUserAddRows="False" IsReadOnly="True" 
                              SelectionMode="Single" GridLinesVisibility="Horizontal"
                              Background="White" BorderBrush="#FFD3D3D3" BorderThickness="1"
                              FontSize="13">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding CustomerID}" Width="50"/>
                            <DataGridTextColumn Header="Họ và Tên" Binding="{Binding CustomerFullName}" Width="200"/>
                            <DataGridTextColumn Header="Số điện thoại" Binding="{Binding Telephone}" Width="120"/>
                            <DataGridTextColumn Header="Email" Binding="{Binding EmailAddress}" Width="250"/>
                            <DataGridTextColumn Header="Ngày sinh" Binding="{Binding CustomerBirthday, StringFormat=dd/MM/yyyy}" Width="100"/>
                            <DataGridTemplateColumn Header="Hành động" Width="150">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="Sửa" Width="60" Height="25" 
                                                    Background="#FF007BFF" Foreground="White"
                                                    Click="btnEditCustomer_Click" Margin="2" Cursor="Hand"/>
                                            <Button Content="Xóa" Width="60" Height="25" 
                                                    Background="#FFDC3545" Foreground="White"
                                                    Click="btnDeleteCustomer_Click" Margin="2" Cursor="Hand"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Room Management Tab -->
            <TabItem x:Name="tabRooms" Header="Quản lý Phòng" FontSize="14">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Search and Actions -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Tìm kiếm:" VerticalAlignment="Center" Margin="0,0,10,0" FontSize="14"/>
                        <TextBox x:Name="txtSearchRoom" Width="300" Height="30" 
                                 Padding="5" VerticalAlignment="Center" FontSize="14"/>
                        <Button x:Name="btnSearchRoom" Content="Tìm kiếm" 
                                Width="80" Height="30" Margin="10,0" FontSize="14"
                                Background="#FF007BFF" Foreground="White" Cursor="Hand"
                                Click="btnSearchRoom_Click"/>
                        <Button x:Name="btnAddRoom" Content="Thêm Phòng" 
                                Width="120" Height="30" Margin="10,0" FontSize="14"
                                Background="#FF28A745" Foreground="White" Cursor="Hand"
                                Click="btnAddRoom_Click"/>
                        <Button x:Name="btnRefreshRoom" Content="Làm mới" 
                                Width="80" Height="30" Margin="10,0" FontSize="14"
                                Background="#FF6C757D" Foreground="White" Cursor="Hand"
                                Click="btnRefreshRoom_Click"/>
                    </StackPanel>

                    <!-- Room DataGrid -->
                    <DataGrid Grid.Row="1" x:Name="dgRooms" AutoGenerateColumns="False"
                              CanUserAddRows="False" IsReadOnly="True" 
                              SelectionMode="Single" GridLinesVisibility="Horizontal"
                              Background="White" BorderBrush="#FFD3D3D3" BorderThickness="1"
                              FontSize="13">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding RoomID}" Width="50"/>
                            <DataGridTextColumn Header="Số phòng" Binding="{Binding RoomNumber}" Width="100"/>
                            <DataGridTextColumn Header="Mô tả" Binding="{Binding RoomDescription}" Width="250"/>
                            <DataGridTextColumn Header="Sức chứa tối đa" Binding="{Binding RoomMaxCapacity}" Width="100"/>
                            <DataGridTextColumn Header="Giá/Ngày" Binding="{Binding RoomPricePerDate, StringFormat=C}" Width="120"/>
                            <DataGridTextColumn Header="Loại phòng" Binding="{Binding RoomType.RoomTypeName}" Width="120"/>
                            <DataGridTemplateColumn Header="Hành động" Width="150">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="Sửa" Width="60" Height="25" 
                                                    Background="#FF007BFF" Foreground="White"
                                                    Click="btnEditRoom_Click" Margin="2" Cursor="Hand"/>
                                            <Button Content="Xóa" Width="60" Height="25" 
                                                    Background="#FFDC3545" Foreground="White"
                                                    Click="btnDeleteRoom_Click" Margin="2" Cursor="Hand"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Booking Management Tab -->
            <TabItem x:Name="tabBookings" Header="Quản lý Đặt phòng" FontSize="14">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Search and Actions -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Tìm kiếm:" VerticalAlignment="Center" Margin="0,0,10,0" FontSize="14"/>
                        <TextBox x:Name="txtSearchBooking" Width="300" Height="30" 
                                 Padding="5" VerticalAlignment="Center" FontSize="14"/>
                        <Button x:Name="btnSearchBooking" Content="Tìm kiếm" 
                                Width="80" Height="30" Margin="10,0" FontSize="14"
                                Background="#FF007BFF" Foreground="White" Cursor="Hand"
                                Click="btnSearchBooking_Click"/>
                        <Button x:Name="btnAddBooking" Content="Thêm Đặt phòng" 
                                Width="120" Height="30" Margin="10,0" FontSize="14"
                                Background="#FF28A745" Foreground="White" Cursor="Hand"
                                Click="btnAddBooking_Click"/>
                        <Button x:Name="btnRefreshBooking" Content="Làm mới" 
                                Width="80" Height="30" Margin="10,0" FontSize="14"
                                Background="#FF6C757D" Foreground="White" Cursor="Hand"
                                Click="btnRefreshBooking_Click"/>
                    </StackPanel>

                    <!-- Booking DataGrid -->
                    <DataGrid Grid.Row="1" x:Name="dgBookings" AutoGenerateColumns="False"
                              CanUserAddRows="False" IsReadOnly="True" 
                              SelectionMode="Single" GridLinesVisibility="Horizontal"
                              Background="White" BorderBrush="#FFD3D3D3" BorderThickness="1"
                              FontSize="13">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding BookingID}" Width="50"/>
                            <DataGridTextColumn Header="Tên Khách hàng" Binding="{Binding Customer.CustomerFullName}" Width="200"/>
                            <DataGridTextColumn Header="Số Phòng" Binding="{Binding Room.RoomNumber}" Width="100"/>
                            <DataGridTextColumn Header="Ngày Nhận phòng" Binding="{Binding CheckInDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Ngày Trả phòng" Binding="{Binding CheckOutDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Tổng Giá" Binding="{Binding TotalPrice, StringFormat=C}" Width="120"/>
                            <DataGridTextColumn Header="Trạng thái" Binding="{Binding BookingStatus, Converter={StaticResource BookingStatusConverter}}" Width="100"/>
                            <DataGridTemplateColumn Header="Hành động" Width="150">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="Sửa" Width="60" Height="25" 
                                                    Background="#FF007BFF" Foreground="White"
                                                    Click="btnEditBooking_Click" Margin="2" Cursor="Hand"/>
                                            <Button Content="Xóa" Width="60" Height="25" 
                                                    Background="#FFDC3545" Foreground="White"
                                                    Click="btnDeleteBooking_Click" Margin="2" Cursor="Hand"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Booking History Tab (Customer only) -->
            <TabItem x:Name="tabBookingHistory" Header="Lịch sử Đặt phòng" FontSize="14" Visibility="Collapsed">
                <Grid Margin="20">
                    <DataGrid x:Name="dgBookingHistory" AutoGenerateColumns="False"
                              CanUserAddRows="False" IsReadOnly="True" 
                              SelectionMode="Single" GridLinesVisibility="Horizontal"
                              Background="White" BorderBrush="#FFD3D3D3" BorderThickness="1"
                              FontSize="13">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding BookingID}" Width="50"/>
                            <DataGridTextColumn Header="Số Phòng" Binding="{Binding Room.RoomNumber}" Width="100"/>
                            <DataGridTextColumn Header="Ngày Nhận phòng" Binding="{Binding CheckInDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Ngày Trả phòng" Binding="{Binding CheckOutDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                            <DataGridTextColumn Header="Tổng Giá" Binding="{Binding TotalPrice, StringFormat=C}" Width="120"/>
                            <DataGridTextColumn Header="Trạng thái" Binding="{Binding BookingStatus, Converter={StaticResource BookingStatusConverter}}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- Profile Tab (Customer only) -->
            <TabItem x:Name="tabProfile" Header="Hồ sơ Cá nhân" FontSize="14" Visibility="Collapsed">
                <Grid Margin="20">
                    <StackPanel Width="400" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <TextBlock Text="Hồ sơ Cá nhân" FontSize="24" FontWeight="Bold" 
                                   HorizontalAlignment="Center" Margin="0,0,0,30" Foreground="#FF4A90E2"/>

                        <TextBlock Text="Họ và Tên:" FontWeight="SemiBold" Margin="0,0,0,5" FontSize="14"/>
                        <TextBox x:Name="txtProfileFullName" Height="35" FontSize="14" Padding="5" MaxLength="50"/>

                        <TextBlock Text="Số điện thoại:" FontWeight="SemiBold" Margin="0,15,0,5" FontSize="14"/>
                        <TextBox x:Name="txtProfileTelephone" Height="35" FontSize="14" Padding="5" MaxLength="12"/>

                        <TextBlock Text="Email:" FontWeight="SemiBold" Margin="0,15,0,5" FontSize="14"/>
                        <TextBox x:Name="txtProfileEmail" Height="35" FontSize="14" Padding="5" IsReadOnly="True"/>

                        <TextBlock Text="Ngày sinh:" FontWeight="SemiBold" Margin="0,15,0,5" FontSize="14"/>
                        <DatePicker x:Name="dpProfileBirthday" Height="35" FontSize="14"/>

                        <TextBlock Text="Mật khẩu:" FontWeight="SemiBold" Margin="0,15,0,5" FontSize="14"/>
                        <PasswordBox x:Name="txtProfilePassword" Height="35" FontSize="14" Padding="5" MaxLength="50"/>

                        <Button x:Name="btnUpdateProfile" Content="Cập nhật Hồ sơ" 
                                Height="40" Margin="0,30,0,0" FontSize="16"
                                Background="#FF007BFF" Foreground="White" Cursor="Hand"
                                Click="btnUpdateProfile_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Report Tab (Admin only) -->
            <TabItem x:Name="tabReports" Header="Báo cáo Thống kê" FontSize="14">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Date Range Selection -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Từ ngày:" VerticalAlignment="Center" Margin="0,0,10,0" FontSize="14"/>
                        <DatePicker x:Name="dpStartDate" Width="150" Height="30" VerticalAlignment="Center" FontSize="14"/>
                        <TextBlock Text="Đến ngày:" VerticalAlignment="Center" Margin="20,0,10,0" FontSize="14"/>
                        <DatePicker x:Name="dpEndDate" Width="150" Height="30" VerticalAlignment="Center" FontSize="14"/>
                        <Button x:Name="btnGenerateReport" Content="Tạo Báo cáo" 
                                Width="120" Height="30" Margin="20,0" FontSize="14"
                                Background="#FF007BFF" Foreground="White" Cursor="Hand"
                                Click="btnGenerateReport_Click"/>
                    </StackPanel>

                    <!-- Report Data -->
                    <Grid Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                            <TextBlock x:Name="txtTotalBookings" Text="Tổng đặt phòng: 0" FontSize="16" FontWeight="SemiBold" Margin="0,0,20,0"/>
                            <TextBlock x:Name="txtTotalRevenue" Text="Tổng doanh thu: 0" FontSize="16" FontWeight="SemiBold"/>
                        </StackPanel>

                        <DataGrid Grid.Row="1" x:Name="dgReportBookings" AutoGenerateColumns="False"
                                  CanUserAddRows="False" IsReadOnly="True" 
                                  SelectionMode="Single" GridLinesVisibility="Horizontal"
                                  Background="White" BorderBrush="#FFD3D3D3" BorderThickness="1"
                                  FontSize="13">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding BookingID}" Width="50"/>
                                <DataGridTextColumn Header="Tên Khách hàng" Binding="{Binding Customer.CustomerFullName}" Width="200"/>
                                <DataGridTextColumn Header="Số Phòng" Binding="{Binding Room.RoomNumber}" Width="100"/>
                                <DataGridTextColumn Header="Ngày Nhận phòng" Binding="{Binding CheckInDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                                <DataGridTextColumn Header="Ngày Trả phòng" Binding="{Binding CheckOutDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                                <DataGridTextColumn Header="Tổng Giá" Binding="{Binding TotalPrice, StringFormat=C}" Width="120"/>
                                <DataGridTextColumn Header="Trạng thái" Binding="{Binding BookingStatus, Converter={StaticResource BookingStatusConverter}}" Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>